<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Petpetta å•†å“åˆ—è¡¨</title>
  <link rel="stylesheet" href="assets/styles.css" />
  <style>/* çœç•¥åŸæœ¬ CSS ... */</style>
</head>
<body>
  <header>
    <h1 id="page-title">Petpetta å•†å“åˆ†é¡</h1>
    <nav><a href="index.html">å›é¦–é </a></nav>
  </header>

  <section id="button-bar" style="text-align:center; padding:1rem;">
    <!-- å‹•æ…‹ç”¢ç”Ÿåˆ†é¡æŒ‰éˆ• -->
  </section>

  <section class="product-grid" id="product-list"></section>

  <footer><p>&copy; 2025 Petpetta å¯µç‰©ç”Ÿæ´»é¤¨</p></footer>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";

    const firebaseConfig = { /* å¡«å…¥å°ˆæ¡ˆè³‡è¨Š */ };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const productList = document.getElementById("product-list");
    const buttonBar = document.getElementById("button-bar");
    const pageTitle = document.getElementById("page-title");
    const urlParams = new URLSearchParams(window.location.search);
    const type = urlParams.get("type");

    // é è¨­åˆ†é¡æŒ‰éˆ•ï¼Œå°‡ä¾†ä¹Ÿå¯æ”¹æˆå¾ Firestore æŠ“ category collection
    const categories = [
      { key: "ç‹—ç‹—å°ˆå€", label: "ğŸ¶ ç‹—ç‹—å°ˆå€" },
      { key: "è²“å’ªå°ˆå€", label: "ğŸ± è²“å’ªå°ˆå€" }
    ];
    categories.forEach(c => {
      const btn = document.createElement("button");
      btn.textContent = c.label;
      btn.style.margin = "0 0.5rem";
      btn.addEventListener("click", () => {
        location.search = `?type=${encodeURIComponent(c.key)}`;
      });
      buttonBar.appendChild(btn);
    });

    async function loadProducts(category) {
      productList.innerHTML = "";
      pageTitle.textContent = category ? `Petpettaï½œ${category}` : "Petpetta å•†å“åˆ†é¡";
      if (!category) {
        productList.innerHTML = '<div class="empty-message">è«‹é¸æ“‡ä¸Šæ–¹åˆ†é¡æˆ–å¾é¦–é é€²å…¥</div>';
        return;
      }

      const querySnapshot = await getDocs(collection(db, "products", category, "products"));
      if (querySnapshot.empty) {
        productList.innerHTML = '<div class="empty-message">ç›®å‰æ­¤åˆ†é¡å°šç„¡å•†å“</div>';
        return;
      }

      querySnapshot.forEach(doc => {
        const data = doc.data();
        const card = document.createElement("div");
        card.className = "product-card";
        card.innerHTML = `
          <img src="${data.image}" alt="${data.name}" />
          <h3>${data.name}</h3>
          <p>åƒ¹æ ¼ï¼š${data.price} å…ƒ</p>
        `;
        productList.appendChild(card);
      });
    }

    loadProducts(type);
  </script>
</body>
</html>
